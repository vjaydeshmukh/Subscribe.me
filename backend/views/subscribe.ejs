<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <title>Subscribe</title>
    <style>
        .center {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;

        }

        .center1 {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100px;
        }
    </style>
</head>

<body onload="init()">
    <div class="container">
        <h4 class="center1" href="#"><img
            src="https://www.paypalobjects.com/webstatic/mktg/Logo/pp-logo-100px.png" border="0"
            alt="PayPal Logo" style="vertical-align: sub;"> <strong><em>Subscriptions</em></strong></h4>
        <h1 class="center1" class="display-5">Subscribe to a Plan</h1>
        <p class="center1 my-0">Plan Id : <%= plan_id %></p>
        <div id="paypal-button" class="center">
            <div class="col-md-4" id="paypal-button-container">
            </div>
        </div>
    </div>
</body>
<script>
    function init() {
        const clientId = '<%= client_id %>';
        const planId = '<%= plan_id %>';
        const url = `https://www.paypal.com/sdk/js?client-id=${clientId}&vault=true&intent=subscription`
        loadScript(url, function () {
            paypal.Buttons({
                createSubscription: function (data, actions) {
                    return actions.subscription.create({
                        'plan_id': planId
                    });
                },
                onApprove: function (data, actions) {
                    alert('You have successfully created subscription ' + data.subscriptionID + " Provide it to the Merchat for tracking the payment.");
                }
            }).render('#paypal-button-container');
            // here you can use anything you defined in the loaded script
        });
    }

    function loadScript(url, callback) {
        // adding the script tag to the head as suggested before
        var head = document.getElementsByTagName('head')[0];
        var script = document.createElement('script');
        script.type = 'text/javascript';
        script.src = url;

        // then bind the event to the callback function
        // there are several events for cross browser compatibility
        script.onreadystatechange = callback;
        script.onload = callback;

        // fire the loading
        head.appendChild(script);
    }
</script>

</html>